# frozen_string_literal: true

load_environment_file "#{site_directory}/.env"

FRONTEND_ENVIRONMENTS = %W[
  ENVIRONMENT=production
  API_URL=#{ENV['API_URL']}
  SENTRY_DSN=#{ENV['SENTRY_DSN']}
].freeze

in_directory(args[:project_path]) do
  in_directory('frontend') do
    build_swo_image(
      image_name: 'better_izivi_develop_frontend',
      build_args: FRONTEND_ENVIRONMENTS
    )
  end

  in_directory('api') do
    build_swo_image(
      image_name: 'better_izivi_develop_api',
      network: 'traefik'
    )
  end
end
